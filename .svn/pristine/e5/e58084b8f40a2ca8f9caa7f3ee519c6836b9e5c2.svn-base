{"version":3,"sources":["../../src/pages/sales-media/sales-media.module.ts","../../src/pages/sales-media/sales-media.ts","../../src/providers/constants/sale-media.ts","../../src/providers/sale-media/index.ts","../../src/providers/sale-media/media-model.ts"],"names":[],"mappings":"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","file":"10.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { SalesMediaPage } from './sales-media';\nimport { ComponentsModule } from './../../components/components.module';\nimport { DirectivesModule } from './../../directives/directives.module';\n\n@NgModule({\n  declarations: [\n    SalesMediaPage,\n  ],\n  imports: [\n    ComponentsModule,\n    DirectivesModule,\n    IonicPageModule.forChild(SalesMediaPage),\n  ],\n})\nexport class SalesMediaPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/sales-media/sales-media.module.ts","import { ResponseModel } from './../../providers/model/response-model';\nimport { AlertDirective } from './../../directives/extends/alert/alert';\nimport { ApiProvider } from './../../providers/api/api';\nimport { FunctionName } from './../../providers/constants/function-name';\nimport { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\nimport { documents, forms } from \"./../../providers/constants/sale-media\";\nimport { Sort } from '@angular/material';\nimport { LoadingDirective } from \"./../../directives/extends/loading/loading\";\nimport { PdfViewdataPage } from '../../pages/pdf-viewdata/pdf-viewdata';\nimport { RequestModel } from \"./../../providers/model/request-model\";\nimport { ServiceName } from '../../providers/constants/service-name';\nimport { SaleMediaData, MediaM } from \"../../providers/sale-media\";\n\nimport _ from \"lodash\";\n\n\n/**\n * Generated class for the SalesMediaPage page.\n *\n * See https://ionicframework.com/docs/components/#navigation for more info on\n * Ionic pages and navigation.\n */\n\n@IonicPage({\n  segment: 'สื่อและเอกสารงานขาย'\n})\n@Component({\n  selector: 'page-sales-media',\n  templateUrl: 'sales-media.html',\n})\nexport class SalesMediaPage {\n  //Decare\n  private documents: object;\n  private datasTable: Array<any> = [];\n  private payType: string;\n\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    public loadingCtrl: LoadingDirective,\n    private apiProvider: ApiProvider,\n    private alertCtrl: AlertDirective,\n    private saleMediaData: SaleMediaData) {\n    console.log('constructor');\n  }\n\n  // Life cycle จังหวะไปเรียก API\n  ionViewDidLoad()\n  {\n    this.documents = documents; // ได้มาจาก import ข้างบน\n    this.payType = '1';\n    this.detailBypayType(1);\n    console.log('ionViewDidLoad')\n  }\n  \n  // select drop down tab3\n  detailBypayType(event)\n  {\n    const parentID = Number(event);\n    this.datasTable = _.filter(forms, doc => (\n      _.includes(doc.parents, parentID)\n    ));\n    //Assign no\n    this.datasTable = _.forEach(this.datasTable, (a, b) =>{\n      a.no = b + 1\n    });\n  }\n\n  //Sort table\n  sortData(sort: Sort)\n  {\n    const { active, direction } = sort\n    this.datasTable = _.orderBy(this.datasTable, _.trimEnd(active, 'F'), direction);\n  }\n\n  // openPDF\n  private async openPDF(form)\n  {\n    const { pdfPath } = form;\n    const pdfData = await this.getMediaPdf(pdfPath);\n    const PDF = {\n      pdfDetail: {\n        pageTotal: 1,\n        pdfName: pdfData.documentname,//fundCode .pdf\n        src: `data:application/pdf;base64, ${pdfData.binarypdf}`,\n      }\n    };\n    // ส่งไปหน้า PDF\n    this.navCtrl.push(PdfViewdataPage, PDF);\n  }\n\n  private async getMediaPdf(mediaName='')\n  {\n    let loading = this.loadingCtrl.scopePresent();\n    let request = new RequestModel();\n    request = {\n      ...request,\n      serviceName: ServiceName.SELECT,\n      functionName: FunctionName.SELLDOCUMENT,\n      sourcePage: mediaName\n    };\n    \n    /**\n     * เช็คข้อมูลใน Provider ก่อน ถ้าไม่มีให้ไปเอามาจาก Service\n     */\n    if (!this.saleMediaData.mediaExist(mediaName)) {\n      const pdfData = await this.apiProvider.callData(request).then(\n        res => {\n          const obj :any = res;\n          const resModel: ResponseModel = obj;\n  \n          if (resModel.size > 0 && resModel.data.length > 0) {\n            const data: MediaM = _.first(resModel.data);\n            this.saleMediaData.setMedia(data);\n            return data;\n          }\n        },\n        err => {\n          this.loadingCtrl.scopeDismiss(loading);\n          this.alertCtrl.error(err);\n          return new MediaM;\n        }\n      );\n\n      this.loadingCtrl.scopeDismiss(loading);\n      return pdfData;\n\n    } else {\n      // มีอยู่แล้วใน provider\n      this.loadingCtrl.scopeDismiss(loading);\n      return this.saleMediaData.getMedia(mediaName);\n    }\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/sales-media/sales-media.ts","export const documents = [\r\n  {id: 1, name: `การพิจารณารับประกัน (New Business)`},\r\n  {id: 2, name: `กรณีประสงค์ซื้อ RSP ภายหลังจากการออกกรมธรรม์`},\r\n  {id: 3, name: `การสับเปลี่ยนกองทุน/ถอนเงินบางส่วน/เวนคืนจากกรมธรรม์`},\r\n  {id: 4, name: `เอกสารทั้งหมดเกี่ยวกับประกันชีวิตควบการลงทุน`}\r\n];\r\n\r\nexport const forms = [\r\n  {id: 1, parents: [1, 4], formName: `คำขอเอาประกันภัยยูนิต ลิงค์`, pdfPath: 'form1'},\r\n  {id: 2, parents: [1, 2, 4], formName: `ใบคำร้องเกี่ยวกับเบี้ยประกันภัย สำหรับการประกันชีวิต แบบยูนิตลิงค์`, pdfPath: 'form2'},\r\n  {id: 3, parents: [3, 4], formName: `ใบคำร้องขอดำเนินการ สำหรับการประกันชีวิต แบบยูนิตลิงค์`, pdfPath: 'form3'},\r\n  {id: 4, parents: [1, 4], formName: `แบบแสดงข้อมูลผู้ถือหน่วยลงทุน (บุคคลธรรมดา)`, pdfPath: 'form4'},\r\n  {id: 5, parents: [1, 4], formName: `แบบสอบถามเพื่อประเมินความเสี่ยง`, pdfPath: 'form5'},\r\n  {id: 6, parents: [2, 4], formName: `ใบแถลงสุขภาพ กรณีซื้อ RSP ภายหลัง`, pdfPath: 'form6'},\r\n  {id: 7, parents: [2, 3, 4], formName: `แบบฟอร์มรับทราบความเสี่ยง (กรณีเลือกกองทุนเกินกว่าความเสี่ยงที่ตนเองยอมรับได้)`, pdfPath: 'form7'},\r\n  {id: 8, parents: [1, 4], formName: `แบบสอบถามเพื่อการวางแผนทางการเงินสำหรับ ยูนิตลิงค์ (เอกสารฉบับนี้ไม่ต้องนำส่งมายังสาขา/สนญ.)`, pdfPath: 'form8'}\r\n];\n\n\n// WEBPACK FOOTER //\n// ./src/providers/constants/sale-media.ts","export { MediaM } from './media-model';\r\nexport { SaleMediaData } from './sale-media-data';\n\n\n// WEBPACK FOOTER //\n// ./src/providers/sale-media/index.ts","export  class MediaM {\r\n  documentname: string;\r\n  binarypdf: string; // base64\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/providers/sale-media/media-model.ts"],"sourceRoot":""}